# ğŸ¤– Bot WhatsApp - Sistema Automatizado

Sistema completo de automaÃ§Ã£o do WhatsApp com envio em massa, transcriÃ§Ã£o de Ã¡udios e anÃ¡lise com IA.

## ğŸ“‹ Funcionalidades

1. **Envio em Massa de Mensagens**
   - PersonalizaÃ§Ã£o com templates (`{nome}`)
   - Suporte a links adicionais
   - Log de mensagens enviadas
   - ValidaÃ§Ã£o de nÃºmeros de telefone

2. **Escuta e TranscriÃ§Ã£o**
   - Monitor automÃ¡tico de chats
   - TranscriÃ§Ã£o de Ã¡udios com Google Speech Recognition
   - Log de mensagens recebidas
   - Suporte a mÃºltiplos formatos de Ã¡udio

3. **Processamento com IA**
   - AnÃ¡lise de mensagens com GPT-3.5-turbo
   - SugestÃµes para melhorar comunicaÃ§Ã£o
   - Foco em otimizaÃ§Ã£o de vendas

## ğŸš€ InstalaÃ§Ã£o

### 1. PrÃ©-requisitos
- Python 3.8+
- Google Chrome instalado
- ChromeDriver compatÃ­vel

### 2. Instalar dependÃªncias
```bash
pip install -r requirements.txt
```

### 3. Configurar variÃ¡veis de ambiente
Crie um arquivo `.env` na raiz do projeto (use `config.env.example` como base):

```env
OPENAI_API_KEY=sua_chave_aqui
AI_ENDPOINT=https://api.openai.com/v1/chat/completions
```

### 4. Preparar arquivo de contatos
Crie ou edite o arquivo `data/contatos.xlsx` com as colunas:
- `nome` ou `name`: Nome do contato
- `telefone`, `phone` ou `numero`: NÃºmero do WhatsApp (com cÃ³digo do paÃ­s)

Exemplo:
| nome  | telefone       |
|-------|----------------|
| JoÃ£o  | 5511999999999  |
| Maria | 5521888888888  |

## ğŸ’» Como Usar

### MÃ©todo 1: Interface Web (Recomendado)

```bash
python main.py
```

Acesse `http://localhost:8080` no navegador e use a interface grÃ¡fica.

### MÃ©todo 2: Scripts Individuais

#### Enviar mensagens:
```bash
# Via variÃ¡veis de ambiente
MSG_TEMPLATE="OlÃ¡ {nome}, como vai?" MSG_LINK="https://exemplo.com" python sender.py
```

#### Escutar e transcrever:
```bash
python listener_transcriber.py
```

#### Processar com IA:
```bash
python ai_process.py
```

## ğŸ“ Estrutura de Arquivos

```
whatsapp_project/
â”œâ”€â”€ main.py                    # Interface web (NiceGUI)
â”œâ”€â”€ sender.py                  # Script de envio de mensagens
â”œâ”€â”€ listener_transcriber.py    # Script de escuta e transcriÃ§Ã£o
â”œâ”€â”€ ai_process.py              # Script de processamento com IA
â”œâ”€â”€ requirements.txt           # DependÃªncias Python
â”œâ”€â”€ config.env.example         # Exemplo de configuraÃ§Ã£o
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ contatos.xlsx          # Lista de contatos
â”‚   â”œâ”€â”€ sent_log.csv           # Log de mensagens enviadas
â”‚   â”œâ”€â”€ received_log.csv       # Log de mensagens recebidas
â”‚   â””â”€â”€ system.log             # Log do sistema
â”œâ”€â”€ profile/                   # Perfil do Chrome (sessÃ£o do WhatsApp)
â””â”€â”€ templates/                 # Templates HTML (legado)
```

## ğŸ”§ CorreÃ§Ãµes Implementadas

### âœ… CorreÃ§Ãµes de Bugs
- âœ… Caracteres Unicode invisÃ­veis em argumentos do Chrome corrigidos
- âœ… Encoding UTF-8 adicionado em todos os arquivos de log
- âœ… ConfiguraÃ§Ã£o de download de Ã¡udios corrigida
- âœ… ValidaÃ§Ã£o de variÃ¡veis de ambiente adicionada

### âœ… Melhorias de Robustez
- âœ… Tratamento completo de exceÃ§Ãµes em todos os scripts
- âœ… ValidaÃ§Ã£o de dados de entrada (contatos, templates, arquivos)
- âœ… Limpeza automÃ¡tica de nÃºmeros de telefone
- âœ… Mensagens de erro descritivas
- âœ… Contadores de sucesso/erro

### âœ… Melhorias de Usabilidade
- âœ… Logs mais informativos com emojis e formataÃ§Ã£o
- âœ… Progresso de envio em tempo real
- âœ… EstatÃ­sticas ao final da execuÃ§Ã£o
- âœ… Timeout de 30s para chamadas de API
- âœ… Retry automÃ¡tico para conexÃ£o com ChromeDriver

## âš ï¸ Avisos Importantes

1. **Perfil do WhatsApp**: O primeiro uso requer login manual no WhatsApp Web. A sessÃ£o fica salva em `profile/`.

2. **Rate Limiting**: O WhatsApp pode bloquear contas que enviam muitas mensagens. Use com moderaÃ§Ã£o.

3. **Estrutura HTML**: O WhatsApp atualiza frequentemente sua interface. Os XPaths podem precisar de ajuste.

4. **API da OpenAI**: Certifique-se de ter crÃ©ditos na sua conta OpenAI.

## ğŸ› SoluÃ§Ã£o de Problemas

### ChromeDriver nÃ£o encontrado
```bash
# Baixe o ChromeDriver compatÃ­vel com sua versÃ£o do Chrome
# https://chromedriver.chromium.org/downloads
```

### Erro de transcriÃ§Ã£o de Ã¡udio
- Verifique sua conexÃ£o com a internet
- O Google Speech Recognition Ã© gratuito mas tem limites

### Timeout no WhatsApp Web
- Aumente os valores de `time.sleep()` se sua conexÃ£o for lenta
- Verifique se o WhatsApp Web estÃ¡ carregando corretamente

### API da OpenAI retorna erro
- Verifique se a `OPENAI_API_KEY` estÃ¡ correta
- Confirme que hÃ¡ crÃ©ditos na conta
- Verifique o status da API: https://status.openai.com/

## ğŸ“ Logs

Todos os logs sÃ£o salvos em:
- `data/system.log` - Log geral do sistema
- `data/sent_log.csv` - HistÃ³rico de mensagens enviadas
- `data/received_log.csv` - HistÃ³rico de mensagens recebidas

## ğŸ” SeguranÃ§a

- âš ï¸ Nunca commite o arquivo `.env` com suas credenciais
- âš ï¸ Mantenha a pasta `profile/` privada (contÃ©m sessÃ£o do WhatsApp)
- âš ï¸ Use com responsabilidade e respeite a privacidade dos contatos

## ğŸ“œ LicenÃ§a

Projeto para uso pessoal. Use com responsabilidade.

---

**Desenvolvido com â¤ï¸ usando Python, Selenium e NiceGUI**

